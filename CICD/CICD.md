## CD시스템 생성

지속적 통합 파이프라인
자동인수 테스트
엔서블로 하는 구성관리

완벽한 시스템을 어떻게 구성할 것인가?

### 1. 도커

구축할 시스템의 중심부 부터 실행 가능한 애플리케이션을 도커 이미지로 패키징 한다.
도커 호스트는 컨테이너화한 애플리케이션을 감싸는 형태로 되어있그먀 웹서비스인 도커 애플리케이션은 도커 호스트위에서 컨테이너로 실행될것이다.
포트포워딩 덕분에 호스트 컴퓨터에서 직접 실행하는것 처럼 동작한다.

### 2. 젠킨스 구성

도커를 구축한 이후에는 젠킨스 환경을 구축한다. 다중 에이전트 노드를 활용하면 동시 고부하 작업도 수월하게 처리가 가능하다.

하나의 젠킨스(모) 가 여러개의 젠킨스 슬레이브를 가질 수 있다. 즉, 젠킨스 마스터가 받은 빌드요청은 슬레이브 중 하나에서 실행된다.
이로써 젠킨스 환경을 이용해 수평적 확장을 기대할 수 있다.

### 3. 지속적 통합 파이프라인

CD에서 중요한 첫 단추인 커밋 스테이지를 생성하여서 깃허브로 커밋을 하면 자동으로 젠킨스 빌드가 실행된다. 이 과정에서 단위테스트나 action의 스크립트를 이용해 테스트를 진행하며 , 컴파일 등의 추가 점검을 수행한다. 젠킨스 빌드가 완료되면 알림메세지를 보내도록하는것이 목표이다.
이를 완료했을 때 CI 파이프 라인을 완벽히 수행한다.

### 4. 자동 인수 테스트

여기서 부터는 도커와 젠킨스를 결합하여 CI 단계가 끝나면 어플리케이션을 패키징한 이후 도커 이미지로 변환한다. 그리고 도커 애플리케이션용 리포지터리의 역할을 하는
도커 레지스트리로 이미지를 전송한다.

인수 테스트를 진행하기 앞서 애플리케이션을 실행시켜야한다. 젠킨스가 도커 호스트 컴퓨터를실행 시키면 도커 레지스트리에서 도커용 애플리케이션을 가져와 실행한다.
애플리케이션이 도커 호스트에서 실행된다면 젠킨스는 큐컴버 프레임워크로 작성된 인수 테스트를 실행한다.

### 5. 쿠버네티스 클러스터링

도커 호스트 하나를 쿠버네티스 클러스터로 교체하고 독립형 애플리케이션 하나를 두개의 의존성이 있는 컨테이너 애플리케이션으로 대체한다.
쿠버네티스를 이용하여 도커 호스트를 묶는 추상화 레이어를 제공하게되고 의존성이 있는 애플리케이션 간의 통신을 가능케 한다.
결과적으로 사용자는 어떤 컴퓨터에 애플리케이션간의 통신을 할 수 있게 한다. 결과적으로 사용자는 어떤 컴퓨터에 애플리케이션이 배포되는지에 대해서 고민할 필요가 없어진다.
단지 몇개의 인스턴스가 실행 되고 있는지만 신경 쓰면 된다.

### 6. 앤서블로 하는 구성 관리
앤서블을 활용하면 다중 환경을 생성 할 수 있다.
여러대의 컴푸터에 동일한 애플리케이션을 배포 할 수 있고 , 테스트환경과 프로덕션 환경을 미러링 할 수 있다.



### 목표.

실질적으로 스테이징 환경에 애플리케이션을 배포하고 인수테스트를 진행하고 , 프로덕션환경에 릴리스 하는것을 목표로한다

마지막으로는 Flyway 마이그레이션을 사용하여 데이터베이스 스키마를 자동으로 관리하는것이다.